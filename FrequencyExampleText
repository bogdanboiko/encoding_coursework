Вступ
Роком виникнення теорії графів одностайно вважається рік 1736,
коли Леонард Ейлер опублікував розв’язок так званої задачі про
кенігсберзькі мости, а також знайшов загальний критерій існування
ейлерового циклу в графі (див. розділ 12).
Отримання дальших суттєвих результатів у цій галузі датують
серединою ХIХ століття. Однак початок проведення активних
систематичних досліджень та становлення теорії графів як
окремішного авторитетного розділу сучасної математики відбулося
ще майже 100 років по тому, тобто в середині ХХ століття. Саме з
цього часу граф стає однією з найпоширеніших і найпопулярніших
математичних моделей у багатьох сферах науки і техніки. Картинка у
вигляді набору точок на площині та ліній, проведених між деякими з
них, стала зручною і наочною формою зображення
найрізноманітніших об’єктів, процесів та явищ (див. розділ 14).
Великою мірою це пов’язано з виникненням, бурхливим розвитком
та поширенням електронних обчислювальних машин і, як наслідок,
значним зростанням ролі задач дискретного характеру. Математика
від "обслуговування" переважно фізики переходить до проникнення
своїх методів у інші сфери людської діяльності. Одним з потужних
інструментів такого проникнення є граф.
Із суто формальної точки зору граф можна розглядати як один з
різновидів алгебраїчної системи (а саме, як модель), а отже, і всю
теорію графів ? як розділ сучасної алгебри. Справді, результати та
методи алгебри широко використовуються в теорії графів. Однак за
останні півстоліття активного інтенсивного та екстенсивного розвитку
теорія графів виробила свою достатньо специфічну власну
проблематику і методологію. На сьогодні теорія графів є однією зі
складових математичного апарату кібернетики, важливим розділом
дискретної математики. Тому теорія графів включається до
навчальних програм університетів і технічних вузів як окрема
дисципліна, або як розділ курсу "Дискретна математика".
Безумовно, в невеликому навчальному посібнику неможливо
викласти весь спектр досягнень сучасної теорії графів. Метою
посібника є ознайомлення з основами теорії графів, деякими
класичними проблемами теорії та методами їх розв’язання. Цей
ввідний курс повинен полегшити зацікавленому читачеві подальше
знайомство з результатами та різноманітними застосуваннями теорії
графів за допомогою монографій і підручників, список яких наведено
в кінці посібника.
Крім традиційних, можна сказати, класичних розділів теорії графів
до матеріалу посібника включено фрагмент теми (див. розділ 7), яку

4

відносять до прикладної теорії алгоритмів і називають "Алгоритми на
графах", або ширше "Комбінаторні алгоритми" [2,7,8].
Дещо спрощено відмінність різних підходів до однієї й тієї ж
проблеми, пов’язаної з графами, можна продемонструвати на
прикладі задачі перевірки ізоморфності двох заданих графів.
Класична (абстрактна) теорія алгоритмів констатує, що ця проблема
є розв’язною. Класична теорія графів уточнює, що для її розв’язання
потрібно перебрати і перевірити не більше, ніж n! варіантів (n ?
кількість вершин в обох графах). Прикладна теорія алгоритмів (і
зокрема, її розділ під назвою "Алгоритми на графах") займається
конструюванням нетривіальних процедур, що дозволяють визначити,
чи є задані графи ізоморфними, і в більшості випадків здійснити цю
перевірку достатньо ефективно за рахунок суттєвого скорочення
перебору можливих варіантів.
Розділ "Алгоритми на графах" є своєрідним містком між
класичною теорією графів та прикладною теорією алгоритмів і
програмуванням. Цей місток з кожним роком розширюється і міцніє.
Деякі математики вже сьогодні відносять розділ "Алгоритми на
графах" до загальної теорії графів [2,7].

1. Поняття графа. Способи завдання графів
Нехай V ? деяка непорожня скінченна множина, а V
(2)
? множина
всіх двохелементних підмножин (невпорядкованих пар різних
елементів) множини V.
Графом (неорієнтованим графом) G називається пара множин
(V,E), де E ? довільна підмножина множини V

(2) (E ?V
(2));

позначається G=(V,E).
Елементи множини V називаються вершинами графа G, а
елементи множини E ? ребрами графа G. Відповідно V називається
множиною вершин і E ? множиною ребер графа G.
Традиційно ребра {v,w} записуються за допомогою круглих дужок
(v,w) (іноді просто vw).
Граф, який складається з однієї вершини, називається
тривіальним.
Оскільки для тривіального графа або так званих порожніх графів
G=(V,?) переважну більшість властивостей та тверджень
перевірити неважко, то надалі не будемо кожен раз при
формулюванні та доведенні тих чи інших загальних тверджень теорії
графів спеціально обумовлювати, що йдеться про нетривіальні
графи (при цьому для тривіального або порожнього графів результат
може бути дещо іншим).

5

Нехай задано граф G=(V,E). Якщо (v,w)?Е, то кажуть, що
вершини v i w є суміжними, у противному разі вершини v i w є
несуміжними. Якщо е=(v,w) ? ребро графа, то вершини v i w
називаються кінцями ребра е. У цьому випадку кажуть також, що
ребро е з’єднує вершини v i w. Вершина v і ребро е називаються
інцидентними, якщо v є кінцем е.
Два ребра називаються суміжними, якщо вони мають спільну
вершину.
Існує декілька способів завдання графів.
Одним зі способів завдання графа G=(V,E) є завдання кожної з
множин V і E за допомогою переліку їх елементів.
Приклад 3.1. Граф G1=(V1,E1), V1={v1,v2,v3,v4} і E1={(v1,v3),
(v1,v4),(v2,v3),(v2,v4),(v3,v4)} ? це граф із чотирма вершинами і п’ятьма
ребрами.
А граф G2=(V2,E2), V2={v1,v2,v3,v4,v5} і E2={(v1,v2),(v2,v4),(v1,v5),
(v3,v2),(v3,v5),(v4,v1),(v5,v4)} ? граф із п’ятьма вершинами і сімома
ребрами.
Граф G=(V,E) зручно зображати за допомогою рисунка на
площині, який називають діаграмою графа G. Вершинам графа G
ставляться у бієктивну відповідність точки площини; точки, що
відповідають вершинам v i w, з’єднуються лінією (відрізком або
кривою) тоді і тільки тоді, коли v i w суміжні вершини. Зрозуміло, що
діаграма графа змінюватиме свій вигляд у залежності від вибору
відповідних точок на площині.
Приклад 3.2. На рисунку 3.1 зображені діаграми графів G1 i G2 з
попереднього прикладу.

G1 G2
Рис 3.1

v1

v3

v2

v4

v2

v1

v5 v4
v3

6

Графи можна задавати також за допомогою матриць.
Занумеруємо всі вершини графа G натуральними числами від 1
до n. Матрицею суміжності A графа G називається квадратна
n?n-матриця, в якій елемент aij i-го рядка і j-го стовпчика дорівнює 1,
якщо вершини vi та vj з номерами i та j суміжні, і дорівнює 0 у
противному разі.
Приклад 3.3. Для графів G1 i G2 маємо відповідно

A1=
0011
0011
1101
1110
?
?
?
?
?
?
?
?
?
?
i A2=
01011
10110
01001
11001
10110
?

?
?
?
?
?
?

?
?
?
?
?

Очевидно, що матриці суміжності графів ? симетричні.
Занумеруємо всі вершини графа G числами від 1 до n і всі його
ребра ? числами від 1 до m. Матрицею інцидентності B графа G
називається n?m-матриця, в якій елемент bij i-го рядка і j-го стовпчика
дорівнює 1, якщо вершина vi з номером i інцидентна ребру ej з
номером j, і дорівнює 0 у противному разі.
Приклад 3.4. Для графів G1 і G2 маємо (ребра графів нумеруємо в
тому порядку, в якому вони виписані в прикладі 3.1)

B1=
11000
00110
10101
01011
?
?
?
?
?
?
?
?
?
?
і B2=

1010010
1101000
0001100
0100011
0010101
?

?
?
?
?
?

?

?
?
?
?
?

Нарешті, ще одним способом завдання графів є списки
суміжності. Кожній вершині графа відповідає свій список. У список,
що відповідає вершині v, послідовно записуються всі суміжні їй
вершини.
Приклад 3.5. Для графів G1 і G2 маємо списки
G1: G2:
v1: v3,v4 v1: v2,v4,v5
v2: v3,v4 v2: v1,v3,v4
v3: v1,v2,v4 v3: v2,v5
v4: v1,v2,v3 v4: v1,v2,v5
v5: v1,v3,v4
Вибір та зручність того чи іншого зі способів завдання графів
залежать від особливостей задачі, яка розв’язується.

7

2. Підграфи. Ізоморфізм графів. Алгебра графів
Граф G1=(V1,E1) називається підграфом графа G=(V,E), якщо
V1?V i E1?E.
Важливі класи підграфів складають підграфи, які отримуються в
результаті застосування до заданого графа операції вилучення
вершини і/або операції вилучення ребра.
Операція вилучення вершини v з графа G=(V,E) полягає у
вилученні з множини V елемента v, а з множини E ? всіх ребер,
інцидентних v.
Операція вилучення ребра e з графа G=(V,E) ? це вилучення
елемента e з множини E. При цьому всі вершини зберігаються.
Графи G1=(V1,E1) і G2=(V2,E2) називаються ізоморфними, якщо
існує таке взаємно однозначне відображення ? множини вершин V1
на множину вершин V2, що ребро (v,w)?E1 тоді і тільки тоді, коли
ребро (?(v),?(w))?E2. Відображення ? називається ізоморфним
відображенням або ізоморфізмом графа G1 на граф G2.
Таким чином, ізоморфні графи відрізняються фактично лише
ідентифікаторами (іменами) своїх вершин. З точки зору теорії графів
ця відмінність не є суттєвою, тому звичайно ізоморфні графи
ототожнюють і, зображаючи графи у вигляді діаграм, або зовсім не
ідентифікують їхні вершини, або нумерують вершини натуральними
числами.
Ізоморфне відображення графа G на себе називається
автоморфізмом графа G. Автоморфізм ? графа G=(V,E), при
якому для кожної вершини v?V виконується ?(v)=v, називається
тривіальним автоморфізмом.
Приклад 3.6. Пропонуємо переконатись, що всі графи, зображені
на рис.3.2, ізоморфні між собою, а графи на рис.3.3 ? не є
ізоморфними.

G1 G2 G3

Рис.3.2

8
H1 H2
Рис.3.3

Відношення ізоморфізму є відношенням еквівалентності на
сукупності графів.
Теорема 3.1. Графи G1 та G2 ізоморфні тоді і тільки тоді, коли
матрицю суміжності (матрицю інцидентності) одного з цих графів
можна одержати з матриці суміжності (матриці інцидентності) іншого
графа за допомогою відповідних перестановок рядків та стовпчиків.
Доведення. Справді, як було зазначено вище, ізоморфні графи G1
і G2 відрізняються між собою лише порядком нумерації вершин, тобто
існує бієктивне відображення ? множини номерів вершин першого
графа на множину номерів вершин другого. Отже, кожен елемент aij
(1)

матриці суміжності A1 графа G1 збігається з елементом a?(i)?(j)

(2) (тобто
елементом, який знаходиться в рядку з номером ?(i) і стовпчику з
номером ?(j)) матриці суміжності A2 графа G2. Таким чином, шляхом
послідовного одночасного обміну місцями (перестановок) рядків і
стовпчиків з номерами i та ?(i) для всіх i=1,2,...,n матрицю суміжності
A1 можна перетворити у матрицю суміжності A2 і навпаки.
Якщо відображення ? відоме, то таке перетворення виконати
неважко. У разі ж, коли потрібно перевірити за допомогою матриць
суміжності, чи є ізоморфними два задані графи з n вершинами
кожний, необхідно здійснити різноманітні одночасні перестановки
рядків і стовпчиків однієї з них. Якщо після чергової з таких
перестановок дістанемо матрицю, яка повністю збігається з іншою,
то ці графи ізоморфні. Однак, щоб в такий спосіб з’ясувати, що
задані графи не є ізоморфними, потрібно виконати всі n!
перестановок рядків і стовпчиків. Вже для порівняно невеликих
значень n здійснити цей перебір практично неможливо навіть за
допомогою обчислювальної машини. У прикладній теорії алгоритмів
розробляються різноманітні алгоритми перевірки ізоморфізму графів,
які для більшості графів (або окремих типів графів) дозволяють
суттєво скоротити обсяг необхідних перевірок [2,7,8].
Для матриць інцидентності графів G1 і G2 з n вершинами і m
ребрами кожний справедливі аналогічні міркування. Відмінність у
тому, що коли G1 і G2 ізоморфні, тоді для їхніх множин вершин існує
бієкція ?, а для множин ребер ? інша бієкція ?. Загальна ж кількість
необхідних кроків для перевірки ізоморфізму графів G1 і G2 у цьому
випадку не перевищує n!m!.

9

Граф G=(V,E) називається повним, якщо будь-які дві його
вершини суміжні (тобто E=V

(2)). Повний граф з n вершинами

позначається Kn.
Очевидно, що будь-яка підстановка множини вершин повного
графа Kn є автоморфізмом цього графа. Тому кількість усіх можливих
автоморфізмів графа Kn дорівнює n!
Для графів можна означити операції об’єднання, перетину і
доповнення.
Об’єднанням графів G1=(V1,E1) і G2=(V2,E2) називається граф
G=(V1?V2,E1?E2); позначається G=G1?G2. Об’єднання G=G1?G2
називається прямою сумою графів G1 i G2, якщо V1?V2=?.
Перетином і різницею графів G1=(V,E1) i G2=(V,E2) з однаковими
множинами вершин називаються графи G?=(V,E1?E2) i G??=(V,E1\E2)
відповідно; позначаються G?=G1?G2 і G??= G1\G2.
Доповненням графа G=(V,E) називається граф
G
=(V,V
(2)\E).

Отже, граф
G
має ту саму множину вершин V, що і граф G, а

вершини графа
G
суміжні тоді і лише тоді, коли вони несуміжні в G.

Для графа G з n вершинами виконується

G =Kn\G.

Таким чином можна означити алгебру графів A=<Г,{?,?,
??
}> (типу
(2,2,1)), носієм якої є множина Г всіх графів. Iснують й інші операції
для графів, отже, сигнатуру алгебри A можна розширювати.
Неважко переконатись у справедливості такого твердження.
Теорема 3.2. Графи G1 i G2 ізоморфні тоді і тільки тоді, коли
ізоморфні їхні доповнення
G
1 i
G
2.

Приклад 3.7. Об’єднання і перетин графів H1 і H2 з попереднього
прикладу зображені на рис.3.4. Доповнення графів G2 i H2 зображені
на рис.3.5.

H1?H2 H1?H2

Рис.3.4

G

2 H

2????????????

Рис.3.5

10
3. Графи та бінарні відношення
Між множиною всіх графів із множиною вершин V і множиною всіх
антирефлексивних симетричних бінарних відношень на V існує
взаємно однозначна відповідність: графу G=(V,E) відповідає
відношення R на V таке, що (v,w)?R тоді і тільки тоді, коли (v,w)?E,
v,w ?V. Зокрема, порожньому графу G=(V,?) відповідає порожнє
відношення на V (R=?), а повному графу ? відношення (V?V)\iV, де
iV ? відношення рівності: iV ={(v,v)| v ?V }.
Очевидно, що операціям об’єднання, перетину і доповнення
графів відповідають аналогічні операції для відношень. Якщо графам
G1 i G2 відповідають відношення R1 i R2 то графам G1?G2, G1?G2, G
1

відповідатимуть відношення R1?R2 R1?R2 i
R
1\iV =(V?V)\(R1?iV).
Якщо R транзитивне відношення, то у відповідному графі G для
кожної пари ребер (v,w),(w, u)?E існує замикаюче ребро (v, u)?E.
4. Степені вершин графа
Степенем ?(v) вершини v називається кількість ребер,
інцидентних вершині v.
Вершина степеня 0 називається ізольованою, а вершина
степеня 1 ? кінцевою (або висячою) вершиною.
Кубічним графом називається граф, степені всіх вершин якого
дорівнюють 3.
Нижченаведені твердження містять прості, але важливі
властивості графів.
Теорема 3.3. У будь-якому графі G=(V,E)

?
v ?V
?(v)=2|E|. (3.1)
Справедливість цього твердження випливає з того, що кожне
ребро графа інцидентне двом вершинам і, значить, у суму степенів
усіх вершин воно вносить дві одиниці.
Теорема 3.4. У будь-якому графі G=(V,E) кількість вершин
непарного степеня парна.
Доведення. Нехай VП ? множина вершин парного степеня, а VН ?
множина вершин непарного степеня графа G. Очевидно, VП ?VН =V i
VП ?VН= ?, тоді
?
v ?V
?(v) =
?
v ?V?
?(v) +
?
v ?V?
?(v) = 2k +
?
v ?V?
?(v) = 2 |E|. Отже,

сума
?
v ?V?
?(v)=2(|E|?k) є парним числом. Оскільки кожен з доданків

11

?(v) цієї суми є числом непарним, то кількість цих доданків є числом
парним.
Відомі такі інтерпретації наведених теорем. Загальна кількість
рукостискань, які здійснюють люди у будь-якій спільноті, завжди
парна. Крім того, кількість людей цієї спільноти, що здійснили
непарну кількість рукостискань, завжди є також парною.
Користуючись теоремою 3.3, неважко довести таке твердження.
Лема 3.1. Кількість ребер у повному графі Kn з n вершинами
дорівнює n(n ?1)/2.
Кожна з n вершин повного графа Kn має степінь n ?1. Отже,
?
v ?V
??(v)=n(n ?1)=2 |E|.

5. Шлях у графі. Зв’язність графів
Маршрутом (або шляхом) у графі G=(V,E) називається
послідовність
v1, e1, v2, e2, ... , ek, vk +1 (3.2)
вершин vi

і ребер ei така, що кожні два сусідні ребра в цій

послідовності мають спільну вершину, отже, ei=(vi

,vi +1), i=1,2,...,k.
Вершина v1 називається початком шляху, а вершина vk +1 ? кінцем
шляху. Всі інші вершини цього шляху називаються проміжними, або
внутрішніми, вершинами.
Кількість k ребер у маршруті називається довжиною маршруту.
Кажуть, що цей маршрут з’єднує вершини v1 і vk +1 або веде з
вершини v1 у вершину vk +1.
Маршрутом довжини 0 вважається послідовність, що складається
з єдиної вершини.
Маршрут, в якому всі ребра попарно різні, називається
ланцюгом. Маршрут, в якому всі проміжні вершини попарно різні,
називається простим ланцюгом.
Маршрут (3.2) називається замкненим (або циклічним), якщо
v1=vk +1. Замкнений ланцюг називається циклом, а замкнений
простий ланцюг ? простим циклом.
Лема 3.2. Будь-який маршрут, що веде з вершини v у вершину w,
містить у собі простий ланцюг, що веде з v у w.
Доведення. Справді, нехай v,e1,v2,e2,...,ek,w ? маршрут M, що веде
з v у w і такий, що серед його проміжних вершин є однакові. Якщо
vi=vj (i < j), то, викинувши з M ділянку (циклічний маршрут) від vi до vj
,

отримаємо маршрут M? ? v,e1,v2,e2,...,vi

,ej +1,...,ek,w, який також веде з
v у w. Якщо M? ? не простий ланцюг, то процедуру вилучення його
внутрішніх циклічних ділянок можна повторити. Врешті-решт
отримаємо простий ланцюг, що з’єднує вершини v і w.

12

Граф, усі ребра якого утворюють простий цикл довжини n,
позначається Cn.
Простий цикл довжини 3 називається трикутником.
Граф називається зв’язним, якщо будь-яка пара його вершин
може бути з’єднана деяким маршрутом.
Компонентою зв’язності (або зв’язною компонентою) графа
G називається його зв’язний підграф такий, що він не є власним
підграфом жодного іншого зв’язного підграфа графа G.
Відстанню між вершинами v і w зв’язного графа (позначається
d (v,w)) називається довжина найкоротшого простого ланцюга, що
з’єднує вершини v і w.
Оскільки кожна вершина графа G=(V,E) з’єднана сама з собою
маршрутом довжини 0, то для всіх v ?V виконується d (v,v)=0.
Означена функція відстані задовольняє три аксіоми метрики,
тобто для будь-яких вершин v,w, u?V виконується
1) d (v,w) ? 0; d (v,w)=0 тоді і тільки тоді, коли v = w;
2) d (v,w)=d (w,v);
3) d (v,w) ? d (v,u)+d (u,w).
Справедливість перших двох аксіом очевидна. Доведемо третю
аксіому, яка носить назву нерівності трикутника. Нехай
v,e1,v2,e2,...,ek,u ? маршрут з v в u, а u,e1
?, u2,e2
?,...,el
?,w ? маршрут з u

у w, тоді послідовність v,e1,v2,e2,...,ek,u,e1
?,u2,e2
?,...,el
?,w ? є
маршрутом, що веде з v у w і має довжину d (v, u)+d (u,w). Зрозуміло,
що цей маршрут не може бути коротшим від найкоротшого маршруту,
що веде з v у w, тому
d (v,w) ? d (v,u)+d (u,w).
Ексцентриситетом e(v) довільної вершини v зв’язного графа
G=(V,E) називається найбільша з відстаней між вершиною v і всіма
іншими вершинами графа G, тобто e(v)=
max
w ?V
{d(v,w)}.

Діаметром зв’язного графа G (позначається D(G)) називається
максимальний з усіх ексцентриситетів вершин графа G. Мінімальний
з усіх ексцентриситетів вершин зв’язного графа G називається його
радіусом і позначається R(G).
Вершина v називається центральною, якщо e(v)=R(G).
Центром графа G називається множина всіх його центральних
вершин.
Вершини v i w графа G називаються зв’язаними, якщо в G існує
існує маршрут, що з’єднує v і w.
Відношення зв’язаності Z рефлексивне, транзитивне і
симетричне, а значить, є відношенням еквівалентності на множині V.
Розглянемо фактор-множину V/Z ={V1,V2,...,Vt }. Підграфи Gi=(Vi
,Ei),

13

де Ei=E?Vi

(2), очевидно, є компонентами зв’язності графа G. Крім

того, виконується G = Gi
i
t
? 1
? .

Цей факт можна сформулювати у вигляді такого твердження.
Теорема 3.5. Будь-який граф однозначно зображається у вигляді
прямої суми своїх компонент зв’язності.
Якщо граф G зв’язний, то всі його вершини попарно зв’язані,
тобто V/Z ={V } i G має єдину зв’язну компоненту, яка збігається із
самим графом G.
Теорема 3.6. Для будь-якого графа G=(V,E) або він сам, або його
доповнення є зв’язним графом.
Доведення. Якщо G зв’язний граф, то твердження теореми
виконується.
Нехай G=(V,E) ? незв’язний граф і G1=(V1,E1) одна з його
компонент зв’язності. Розглянемо графи G1 i G?=(V ?,E ? ), де V ?=V \V1
і E?=E \E1. Для будь-якої пари вершин v?V1 i w?V ? у графі
G
існує
ребро (v,w), тому що ці вершини є несуміжні в графі G. Відтак,
оскільки для кожної пари вершин v1,v2?V1 графа G1 і довільної
вершини w?V ? існують ребра (v1,w) i (v2,w), які належать множині
ребер графа
G
, то в графі
G
такі вершини v1 і v2 є зв’язаними.

Аналогічно встановлюємо зв’язність у графі
G
будь-якої пари вершин

w1 i w2 з множини V ?. Отже, всі пари вершин графа
G
зв’язані між

собою.
Наслідок 3.6.1. Якщо G незв’язний граф, то граф
G
зв’язний і

D(
G
)? 2.
Справді, якщо G незв’язний граф, то з доведення теореми
випливає, що
G
зв’язний і для будь-яких двох вершин v та w графа

G
виконується або d(v,w)=1, або d(v,w)=2.
Доведена теорема дозволяє звести розв’язання деяких важливих
проблем теорії графів до випадку зв’язних графів. Зокрема, це
стосується проблеми встановлення ізоморфізму заданих графів G1 i
G2 (див. теорему 3.2).
Теорема 3.7.Нехай G=(V,E) зв’язний граф і e деяке його ребро.
Розглянемо граф G ?, який отримано з G вилученням ребра e:
а) якщо ребро e належить деякому циклу графа G, то граф G ? є
зв’язним графом;
б) якщо ребро e не належить жодному циклу графа G, то граф G ?
не є зв’язним графом і має рівно дві компоненти зв’язності.
Доведення. а) Розглянемо довільні дві вершини v і w графа G ?.

14

Якщо маршрут M, що з’єднує вершини v і w у зв’язному графі G,
не містить ребра e, то цей же маршрут з’єднуватиме вершини v та w і
в графі G ?. Якщо ж ребро e належить маршруту M і e=(u1,u2), то
маршрут, що веде з v у w у графі G ?, можна побудувати так: беремо
маршрут, що веде з v в u1, додаємо до нього ту частину циклу, що
містив ребро e, яка залишилась у графі G? і з’єднує вершини u1 і u2;
відтак, завершуємо його маршрутом з u2 у w. Отже, граф G ?
зв’язний.
б) Нехай ребро e=(u1,u2) не належить жодному циклу графа G.
Тоді в графі G ? вершини u1 та u2 будуть незв’язаними і належатимуть
двом різним компонентам зв’язності G1 та G2 графа G ?. Крім того, у
графі G? стануть незв’язаними ті і тільки ті вершини, які були з’єднані
в графі G маршрутом, що містив ребро e. Отже, кожна вершина v у
G? буде зв’язаною або з вершиною u1, або з вершиною u2, тобто v
належатиме або G1, або G2.
Теорему доведено.
Теорема 3.8. Нехай G=(V,E) граф з n вершинами і k
компонентами зв’язності. Тоді число його ребер m задовольняє такі
нерівності: n?k ? m ?(n?k)(n?k +1)/2.
Доведення. Нижню оцінку m? n?k доведемо індукцією за кількістю
ребер у графі G.
Якщо m=0, то очевидно, що n=k і нерівність виконується.
Припустімо, що для всіх графів з числом ребер m? t (t?0)
відповідна нерівність виконується. Розглянемо граф G з n
вершинами і k компонентами зв’язності, який містить t +1 ребро.
Вилучимо з графа G довільне ребро. Тоді згідно з теоремою 3.7
отримаємо граф G? з n вершинами, t ребрами і кількістю компонент
зв’язності, яка дорівнює k або k +1. За припущенням індукції
виконується або t ?n?k, або t ?n?(k +1). Для обох випадків маємо
t +1? n?k. Отже, бажана нерівність для графа G виконується.
Доведемо верхню оцінку. Розглянемо довільний граф G, що має n
вершин, k компонент зв’язності та максимально можливу кількість
ребер m. Тоді всі його зв’язні компоненти є повними графами. Нехай
Kt
і Ks ? такі дві компоненти зв’язності графа G, що t ? s>1. Виконаємо
таке перетворення графа G: перенесемо одну вершину v із
компоненти Ks у компоненту Kt

, тобто вилучимо вершину v з Ks і

додамо до Kt

, з’єднавши її з усіма вершинами Kt

. Дістанемо граф G? з
n вершинами, k компонентами зв’язності і кількістю ребер
m? =m ?(s ?1)+t =
=m+(t ?s +1)> m. Остання нерівність суперечить припущенню про

15

максимальність числа ребер у графі G. Отже, шуканий граф з n
вершинами, k компонентами зв’язності й найбільшою кількістю ребер
має таку структуру: k ?1 його компоненти зв’язності є тривіальними
графами, а остання компонента є повним графом з n ?k +1
вершиною. Кількість ребер у такому графі дорівнює
(n ? k)(n ? k +1)/2 (див. лему 3.1).
Наслідок 3.8.1. Довільний зв’язний граф з n вершинами містить не
менше ніж n ?1 ребро.
Наслідок 3.8.2. Якщо в графі G з n вершинами кількість ребер
більша ніж (n ?1)(n ?2)/2, то граф G зв’язний.
6. Перевірка зв’язності графів
Зв’язність заданого графа G зручно перевіряти за допомогою його
матриці суміжності A.
Теорема 3.9. Нехай A ? матриця суміжності графа G=(V,E) з n
вершинами (|V |=n). Тоді елемент aij

(k) i-го рядка і j-го стовпчика

матриці A
k
дорівнює кількості шляхів довжини k, які ведуть в графі G

з вершини vi у вершину vj
.

Доведення проведемо індукцією за k.
Для k=1 aij

(1)=aij . За означенням матриці A aij дорівнює 1 тоді і
тільки тоді, коли в графі G з вершини vi веде ребро у вершину vj
. Але

єдиний можливий шлях довжини 1 з vi у vj ? це ребро (vi

,vj). Отже, aij
(1)

дорівнює кількості шляхів довжини 1 з vi у vj
.

Припустімо, що твердження теореми справджується для
k=m ?1, m ? 2. Розглянемо елемент aij

(m) матриці A
m
. Оскільки A
m
=A

m-
1A, то

aij
(m)
=
t
n
?
?
1
ait
(m-1) atj =
t
n
?
?
1
ait
(m-1)atj
(1)
.
Розглянемо окремий доданок ait
(m-1)atj
(1) останньої суми. За

припущенням індукції aij

(m-1) дорівнює кількості шляхів довжини

m?1, які ведуть з вершини vi у вершину vt

; тоді добуток ait
(m-1)atj
(1)
дорівнює кількості шляхів довжини m, що ведуть з вершини vi у
вершину vj

і передостанньою вершиною яких є vt

. Отже, сума таких
доданків для всіх t від 1 до n дає шукану кількість шляхів довжини m з
vi у vj
. Теорему доведено.
Наслідок 3.9.1. Нехай A ? матриця суміжності графа G=(V,E) з n
вершинами. В графі G вершини vi

i vj (i ? j) є зв’язаними тоді і тільки

тоді, коли елемент і-го рядка і j-го стовпчика матриці A+A
2
+A
3
+...+A
n -

1 не дорівнює нулю.
Це випливає з доведеної теореми та тієї простої властивості, що
коли в графі G з n вершинами існує шлях між вершинами vi

i vj (i ? j),

16

тоді між цими вершинами обов’язково існує шлях довжини не більшої
ніж n ?1.
Крім того, щоб вилучити умову i ? j для встановлення зв’язності
між будь-якими вершинами графа G можна використовувати
матрицю M
(n)
=In+A+A
2
+A
3
+...+A
n-1
, де In ? одинична матриця порядку n
(нагадаємо, що будь-яка вершина є зв’язаною сама з собою шляхом
довжини 0).
Наслідок 3.9.2. Граф G буде зв’язним тоді і тільки тоді, коли в
матриці M

(n) немає нульових елементів.
Граф G
?
=(V,E
?
) називається транзитивним замиканням

даного графа G=(V,E), якщо (v,w)?E
?
тоді і тільки тоді, коли вершини

v і w є зв’язані в графі G.
Таким чином, транзитивне замикання графа G є повним графом
тоді і тільки тоді, коли граф G зв’язний.
Якщо графу G=(V,E) відповідає відношення R на V, то графу G
?

відповідатиме транзитивне замикання R
?
відношення R.

Побудуємо для графа G
?
n?n-матрицю A
?
за таким правилом: (i,j)-

тий елемент матриці A
?
дорівнює 1 тоді і тільки тоді, коли

відповідний елемент матриці M

(n) не дорівнює 0, всі інші елементи

матриці A
?
дорівнюють 0.

Матрицю A
?
називають матрицею досяжності графа G (інші

назви: матриця зв’язності, матриця зв’язку).
Обчислення матриці досяжності A
?
графа G
?
можна здійснити й

іншим методом.
Позначимо через A

(1) бульову матрицю, елементи якої повністю
збігаються з елементами матриці A, але розглядаються не як числа 0
і 1, а як символи бульового алфавіту 0 і 1. Введемо операцію
бульового множення С ? D матриць С і D, які складаються з бульових
елементів 0 і 1, таким чином: елемент fij матриці С ? D дорівнює
f ij =
t
n
?
?
1
(cit ? dtj), де сit і dtj ? елементи матриць С і D, а операції ? і ? ?
це операції диз’юнкції та кон’юнкції.
Позначимо через A

(m) матрицю A
(1)
?A
(1)
?...?A
(1) (m разів).
Аналогічно теоремі 3.9 може бути доведена така теорема.
Теорема 3.10. Нехай A
(1)
? бульова матриця, яка відповідає

матриці суміжності A графа G=(V,E). Елемент bij

(m) (i?j) матриці A
(m)
дорівнює 1 тоді і тільки тоді, коли в графі G існує принаймні один
шлях довжини m, що веде з вершини vi у vj
.

17
Наслідок 3.10.1. Матриця досяжності A
?
графа G з n вершинами

може бути обчислена за формулою A
?
=In
(1)
?A
(1)
?A
(2)
?...?A
(n-1)
.

(Операція диз’юнкції виконується для матриць поелементно).
Наслідок 3.10.2. Граф G є зв’язний тоді і тільки тоді, коли всі
елементи його матриці досяжності A
?
дорівнюють 1.

7. Пошук шляхів у графі
Користуючись методами, викладеними в попередньому розділі,
можна визначити зв’язність (тобто наявність або відсутність шляху)
між будь-якими вершинами vi

і vj заданого графа G=(V,E). Однак
часто буває необхідним не просто встановити існування шляху між
заданими вершинами, але й знайти послідовність вершин і ребер
(шлях), що веде з vi у vj
.

Крім того, для різних практичних застосувань теорії графів
важливою є проблема систематичного обходу (перебору) всіх
вершин і/або ребер графа.
Двома класичними методами розв’язання цих проблем є: метод
або алгоритм пошуку (обходу графа) вшир та метод або алгоритм
пошуку (обходу графа) вглиб.
Сформулюємо постановку проблеми пошуку та обидва методи її
розв’язання.
Нехай задано граф G=(V,E), VO ?V ? множину початкових вершин
і VK ?V ? множину кінцевих (заключних, цільових) вершин графа G.
Необхідно знайти шлях з деякої вершини v ?VO в одну з вершин
w ?VK , тобто знайти послідовність ребер (vi

,vi +1)?E, і =1,2,...,t ?1 таку,

що v1= v і vt= w.
Зокрема, множина початкових вершин VO і/або множина кінцевих
вершин VK можуть містити тільки по одній вершині. Такі вершини
природно називати початковою і кінцевою вершинами графа G.
Для опису алгоритмів нам знадобляться три списки ребер ВІДКР,
ЗАКР і РОЗВ. Крім того, для вершини v ?V через S (v) будемо
позначати множину всіх вершин w ?V таких, що в графі G існує ребро
(v,w)?E. Такі вершини w часто називають синами вершини v, а
множину S(v) ? множиною синів вершини v.
Для зручності додамо до множини вершин V графа G "порожню"
вершину p, а до множини ребер - "порожні" ребра виду (р,v), де
v ?VO. При визначенні шляху з VO у VK "порожні" ребра не
враховуються.
Оскільки в запропонованій нижче формі обидва алгоритми пошуку
відрізняються тільки в одній позиції, викладемо їх одночасно і
відзначимо те місце, яким вони різняться між собою.

18
Алгоритм пошуку вшир / вглиб.
1. Всі "порожні" ребра розмістити у списку ВІДКР (у довільному
порядку).
2. Якщо ВІДКР = ?, то РОЗВ = ? (тобто сформульована задача не
має розв’язку) і алгоритм завершує свою роботу.
3. Закрити перше ребро (v,w) з ВІДКР, тобто перенести ребро
(v,w) зі списку ВІДКР у список ЗАКР.
4. Якщо вершина w закритого ребра є кінцевою вершиною (w?VK),
то шуканий список РОЗВ (тобто шуканий шлях з VO у VK) міститься
серед ребер списку ЗАКР і може бути виділений з нього послідовно,
починаючи з останнього закритого ребра шляху. Зауважимо, що при
побудові результуючого шляху для кожного з ребер (v,w) списку ЗАКР
необхідно вибирати ребро-попередника (u,v) так, що воно є першим
ребром з кінцем v у списку ЗАКР. Алгоритм завершує свою роботу.
У противному разі (w ?VK) перейти до пункту 5.
5. Визначити S(w) ? множину синів вершини w останнього
закритого ребра, а також множину ребер R(w)={(w,z) | z?S(w)}.
Розмістити у списку ВІДКР усі ребра з множини
R (w)\(ВІДКР ? ЗАКР) після / перед усіх ребер, що вже містяться в
цьому списку.
6. Перейти до пункту 2.
Відмінність між обома алгоритмами пошуку знаходиться в позиції
5 і полягає в тому, що в алгоритмі пошуку вшир необхідно
розміщувати відповідні ребра після, а в алгоритмі пошуку вглиб ?
перед усіма ребрами, що знаходяться в списку ВІДКР.
Для наведених алгоритмів вживають скорочені назви АПШ і АПГ
(відповідні англійські назви ? BFS (breadth first search) i DFS (depth
first search)).
Таким чином, для АПШ список ВІДКР є чергою, тобто такою
сукупністю елементів, в якій нові елементи розміщуються в кінці
сукупності, а елемент, що "обслуговується" (закривається),
вибирається з голови (початку) цієї сукупності. У той час для АПГ
список ВІДКР є так званим стеком, тобто сукупністю, в якій
елементи, що додаються до сукупності, і елементи, що відбираються
для "обслуговування", розміщуються тільки на початку сукупності - у
верхівці стеку (за принципом: “останній прийшов - перший
обслуговується”).
Приклад 3.8. Розглянемо дію алгоритму пошуку вшир для графа,
зображеного на рис.3.6 (див. таблицю 3.1). Вважаємо, що VO= {3} i
VK= {11}.

19
Рис.3.6

Кожний рядок таблиці описує результат виконання одного
циклічного кроку (позиції 2?6) алгоритму. Оскільки список ЗАКР тільки
поповнюється і на кожному кроці поповнюється тільки одним ребром,
то в таблиці записуємо лише це ребро (не повторюючи всі елементи,
які ввійшли до складу ЗАКР на попередніх кроках). Нагадаємо також,
що ребра (v,w) і (w,v) збігаються.

Таблиця 3.1.

Алгоритм пошуку вшир (АПШ)
Крок ВІДКР ЗАКР w R (w)
0 (p,3)
1 (3,2),(3,4) (p,3) 3 (3,2),(3,4)
2 (3,4),(2,1),(2,4),(2,5),(2,6) (3,2) 2 (2,1),(2,4),(2,5),(2,6)
3 (2,1),(2,4),(2,5),(2,6),(4,5),(4,8) (3,4) 4 (4,5),(4,8)
4 (2,4),(2,5),(2,6),(4,5),(4,8) (2,1) 1
5 (2,5),(2,6),(4,5),(4,8) (2,4) 4
6 (2,6),(4,5),(4,8),(5,8) (2,5) 5 (5,8)
7 (4,5),(4,8),(5,8),(6,7) (2,6) 6 (6,7)
8 (4,8),(5,8),(6,7) (4,5) 5
9 (5,8),(6,7),(8,7),(8,9) (4,8) 8 (8,7),(8,9)
10 (6,7),(8,7),(8,9) (5,8) 8
11 (8,7),(8,9) (6,7) 7 (7,12),(7,11),(7,9),(7,10)
12 (8,9),(7,12),(7,11),(7,9),(7,10) (8,7) 7
13 (7,12),(7,11),(7,9),(7,10) (8,9) 9
14 (7,11),(7,9),(7,10),(12,10),(12,11) (7,12) 12 (12,10),(12,11)
15 (7,9),(7,10),(12,10),(12,11) (7,11) 11
Алгоритм завершує свою роботу на п’ятнадцятому кроці.
Аналізуючи список ребер ЗАКР від його кінця до початку, будуємо
список РОЗВ, тобто знаходимо шуканий шлях від вершини 3 у
вершину 11: 3,(3,2),2,(2,6),6,(6,7),7,(7,11),11. Довжина цього шляху ?
4.

3
2

1

4
5
6 7

8 9
10

11

12

20

Радимо побудувати аналогічну таблицю для алгоритму пошуку
вглиб шляху з вершини 3 у вершину 11 і порівняти дію та результати
обох алгоритмів.
8. Аналіз та модифікації алгоритмів пошуку
Відзначимо деякі найважливіші характеристики та порівняємо
алгоритми пошуку між собою.
1. Обидва алгоритми гарантують знаходження розв’язку, якщо цей
розв’язок існує.
Це випливає з того, що обидва алгоритми аналізують всі вершини
і всі ребра графа,а значить, або гарантовано знаходять шуканий
шлях, або встановлюють відсутність розв’язку.
2. Складність обох алгоритмів (тобто кількість кроків, які повинен
здійснити кожен алгоритм, щоб знайти розв’язок або встановити, що
розв’язку не існує) не перевищує величини O(n +m), де n ? кількість
вершин, а m ? кількість ребер графа G.
Справді, кожне з m ребер графа аналізується не більше одного
разу. А кількість кроків для визначення множини ребер R(w) (крок 5
алгоритму) має порядок числа вершин графа.
3. Якщо |VO|=1, то АПШ знаходить шлях мінімальної довжини з VO
у VК. Якщо ж |VO|>1, то для пошуку найкоротшого шляху з VO у VК
необхідно дещо модифікувати АПШ. А саме, необхідно знайти всі
шляхи з вершин множини VO у множину вершин VК, порівняти їх за
довжиною і обрати мінімальний.
4. Розв’язок, який знаходить АПГ, взагалі кажучи, не оптимальний.
У найгіршому випадку АПГ може знайти шлях з VO у VК довжини n ?2,
у той час як існує шлях довжини 1.
5. АПГ легше програмується:
? за рахунок використання стека;
? завдяки можливості запису АПГ у компактній та наочній
рекурсивній формі.
6. АПГ є складовою частиною багатьох важливих алгоритмів для
графів (побудова кістякового дерева, пошук зв’язних компонент,
топологічне сортування вершин орграфа, пошук розділювальних
вершин, перевірка планарності графа тощо [2,7,8]).
7. Пам’ять, яку використовує АПГ, взагалі кажучи, менша за
обсягом ніж та пам’ять, яка необхідна АПШ.
8. Аналіз людського мислення свідчить, що людині більш
притаманний АПГ при пошуках розв’язків різних задач або під час
проведення досліджень (пошуки шляху в лабіринті, аналіз шахових
комбінацій, розв’язування логічних задач, спелеологічні дослідження
тощо).

21

Розглянемо деякі важливі модифікації алгоритмів пошуку.
Далі для зручності вважатимемо, що |VO|=1.
У великих графах (тобто у графах зі значною кількістю вершин і
ребер) АПГ має одну суттєву ваду, яка є наслідком довільності
розміщення ребер з R(w) у списку ВІДКР (крок 5). Зробивши на
деякому кроці "помилковий" ("неоптимальний") вибір продовження
шляху, АПГ може пройти повз існуючий коротший шлях і заглибитися
в граф у пошуках значно довшого і гіршого шляху.
Спробою усунути цю ваду є так званий алгоритм обмеженого
пошуку вглиб (АОПГ). У цьому алгоритмі кожен шлях з VO
простежується вглиб доти, поки його довжина не досягне певної
наперед заданої граничної величини k. Після цього алгоритм не
поповнює список ВІДКР (крок 5), а починає досліджувати інший шлях,
повернувшись до останнього розгалуження і т. д.
На жаль, ще більш серйозною вадою АОПГ порівняно з АПГ є те,
що він може не знайти жодного розв’язку, в той час, як розв’язок
існує. Ця ситуація може виникнути в тому разі, коли довжина
розв’язку більша від k.
Тому застосовують нижченаведену модифікацію, яка носить назву
алгоритму поступового (або прогресивного) загиблення (АПЗ).
Якщо для заданого k АОПГ розв’язку не знайшов, то значення k
збільшується на певну величину t (тобто k :=k +t) і АОПГ повторює
свою роботу спочатку.
Очевидно, що коли k ? n ?1, де n=|V |, тоді АПЗ збігається з АОПГ і
обидва вони збігаються з класичним АПГ.
Якщо ж k =1 і t =1, то АПЗ збігається з АПШ.
Таким чином, добираючи значення k і t, можна реалізувати певний
компроміс між АПГ і АПШ.
Обидва алгоритми дуже просто можна модифікувати для того,
щоб здійснити систематичний обхід усіх вершин і/або всіх ребер
графа. Результатом такого обходу є певна нумерація (порядок
розташування) вершин і/або ребер.
Цю модифікацію одержимо, якщо вилучимо в кроці 4 перевірку
w ?VК (а отже, фактично вилучимо весь крок 4), і єдиною умовою
завершення алгоритму пошуку залишимо умову кроку 2 (список
ВІДКР ? порожній).
Відповіддю (результатом дії) такого алгоритму буде або список
ребер у ЗАКР і/або та послідовність, в якій аналізувалися вершини на
кроці 5 (без повторень).
Нарешті, ще однією цікавою і важливою задачею, при розв’язанні
якої використовують наведені алгоритми, є задача пошуку шляху
найменшої вартості.

22

Нехай задано граф G=(V,E) і деяку дійсну функцію f :E?R
+
, де R
+
? множина невід’ємних дійсних чисел. Такий граф, кожному ребру
якого поставлене у відповідність невід’ємне дійсне число, що
називаєтся вартістю (вагою, ціною) ребра, називається зваженим
(позначеним) графом.
Тоді вартістю (вагою) шляху M, ребрами якого є ei1,ei2,...,eik,
називають величину W =
j
k
?
?
1
f (eij).

Нехай VO ?V і VК ?V множини початкових і кінцевих вершин
зваженого графа G =(V,E). Алгоритми, які шукають шляхи найменшої
вартості з VO у VК, називаються алгоритмами пошуку найкоротших
шляхів. Вони описані в [2,7,8].
9. Деякі важливі класи графів: дерева та двочасткові
графи
Граф без циклів називається ациклічним.
Ациклічний зв’язний граф називається деревом.
Довільний ациклічний граф називається лісом.
Очевидно, що зв’язними компонентами лісу є дерева, і тому,
кожен ліс може бути зображений у вигляді прямої суми дерев.
Дерева ? це особливий і дуже важливий клас графів. Особлива
роль дерев визначається як широким їхнім застосуванням у різних
галузях науки і практики, так і тим особливим положенням, яке
дерева займають у самій теорії графів. Останнє випливає з граничної
простоти будови дерев. Часто при розв’язуванні різних задач теорії
графів їхнє дослідження починають з дерев. Зокрема, порівнюючи
нескладною є проблема перевірки ізоморфності дерев.
Існують й інші, рівносильні наведеному, означення дерева, які
можна розглядати як характеристичні властивості дерева.
Теорема 3.11. Для графа G =(V,E), |V |=n, |E|=m такі твердження
рівносильні:
1) G ? дерево (ациклічний зв’язний граф);
2) G ? зв’язний граф і m=n?1;
3) G ? ациклічний граф і m=n?1;
4) для будь-яких вершин v і w графа G існує лише один простий
ланцюг, що з’єднує v і w;
5) G ? ациклічний граф такий, що коли будь-які його несуміжні
вершини v i w з’єднати ребром (v,w), то одержаний граф міститиме
рівно один цикл.
Доведення. Для доведення теореми покажемо виконання такого
ланцюжка логічних слідувань: 1)?2), 2)?3), 3) ?4), 4) ?5) і 5) ?1).

23

Оскільки відношення логічного слідування є транзитивним, то звідси
випливатиме рівносильність усіх п’яти тверджень.
Для тривіального графа G (n=1) справедливість твердження
теореми очевидна, тому вважатимемо, що n>1.
1) ?2). Доведемо це твердження методом математичної індукції
за значенням n.
Для n=2 умову 1) задовольняє тільки один граф K2, він же
задовольняє й умову 2).
Припустімо, що твердження виконується для всіх дерев з
кількістю вершин n?t (t ?2). Розглянемо довільне дерево G=(V,E), в
якому t+1 вершина. Вилучимо з G деяке ребро e?E. За теоремою
3.7,б отримаємо граф G?, який складається з двох ациклічних
зв’язних компонент, тобто з двох дерев T1 і T2. Нехай дерево T1 має
n1 вершин і m1 ребер, а дерево T2 ? n2 вершин і m2 ребер, n1 ?t і n2 ?t.
За припущенням індукції маємо: m1=n1 ?1 і m2=n2 ?1. Отже, для
зв’язного графа G виконується
m=m1+m2=(n1 ?1)+(n2 ?1)+1=n1+n2 ?1=(t+1)?1=t.
2) ?3). Від супротивного. Припустімо, що в графі G є цикл.
Вилучивши в G довільне ребро e цього циклу, за теоремою 3.7,а
дістанемо зв’язний граф G?, в якому n?2 ребра. Останнє суперечить
наслідку 3.8.1. Отже, граф G ациклічний.
3)?4). Знову скористаємось методом доведення від
супротивного. Припустімо, що для графа G виконується умова 3), але
граф G є незв’язний і має k компонент зв’язності. Тоді кожна з цих
зв’язних компонент Ti є ациклічною, тобто деревом. Нехай дерево Ti
має ni вершин і mi ребер, i=1,2,...,k. З доведеного вище маємо
mi=ni ?1, i=1,2,...,k. Тоді n?1=m=m1+m2+...+mk=
=(n1 ?1)+(n2 ?1)+...+(nk ?1)=(n1+n2+...+nk) ? k = n?k. Отже, k=1 і G є
зв’язним графом.
Відтак, припустімо, що граф G задовольняє умову 3), але має дві
вершини v і w, які можуть бути з’єднані двома різними простими
ланцюгами. Ці ланцюги утворюють циклічний маршрут, що веде з v у
v і обов’язково містить у собі деякий цикл (доведіть це самостійно).
Останнє суперечить умові 3).
4)?5). Якщо припустити, що в графі G є цикл, тоді будь-які дві
вершини цього циклу можуть бути з’єднані між собою принаймні
двома простими ланцюгами. Отже, G ? ациклічний граф. Візьмемо
будь-які дві несуміжні вершини v і w у графі G і додамо до нього
ребро (v,w); дістанемо граф G ?. У графі G? є один цикл Z, який
складається з простого ланцюга, що веде з v у w у графі G, та
доданого ребра (v,w). Припустімо, що в графі G? є ще один цикл Z1

24

(Z1 ?Z). Цикли Z1 і Z мають спільні ребра (у противному разі Z1 є
циклом ациклічного графа G). Якщо серед цих ребер немає ребра
(v,w), то знову отримаємо, що Z1 є цикл у графі G. Отже, цикли Z і Z1
мають спільне додане ребро (v,w). Тоді частина циклу Z, що веде з v
у w, разом з частиною циклу Z1, що веде з w у v, утворює замкнений
(циклічний) маршрут, що веде з v у v у графі G. Зазначені частини
циклів Z і Z1 не збігаються, тому цей циклічний маршрут міститиме в
собі цикл, що суперечить ациклічності графа G.
5)?1). Необхідно довести, що G ? зв’язний граф. Припустімо, що
це не так. Візьмемо дві довільні вершини v і w з двох різних
компонент зв’язності графа G і з’єднаємо їх ребром; дістанемо граф
G?. Оскільки обидві компоненти є ациклічними графами, то граф G?
також не міститиме циклів. Це суперечить умові 5).
Теорему 3.11 доведено.
Наслідок 3.11.1. Для довільного дерева T=(V,E) з n вершинами
виконується
?
v ?V
?(v)=2(n?1).

Наслідок 3.11.2. Будь-яке нетривіальне дерево T=(V,E) має
принаймні дві кінцеві вершини.
Припустімо, що дерево T має менше двох кінцевих вершин. Тоді
степінь лише однієї вершини може дорівнювати 1, а степені всіх
інших вершин не менші 2. Отже,
?
v ?V
?(v)?2(n?1)+1=2n?1, що

суперечить наслідку 3.11.1.
Наслідок 3.11.3. Ліс F, який має n вершин і складається з k дерев,
містить n?k ребер.
Справді, якщо дерево Ti лісу F має ni вершин, то за доведеною
теоремою воно містить ni ?1 ребро, i=1,2,...,k. Додаючи кількості
ребер кожного з дерев Ti

, дістанемо число n?k ребер в F.

Наслідок 3.11.4. В графі G з n вершинами, який має більше ніж
n?1 ребро, є принаймні один цикл.
Розглянемо довільний граф G з n вершинами та кількістю ребер,
яка перевищує n?1. Припустімо, що G ациклічний граф. Тоді G ? ліс,
що складається з k дерев (k ?1). За попереднім наслідком кількість
ребер у такому графі дорівнює n?k і
n?k>n?1, тобто k<1, що неможливо.
Кістяковим (каркасним) деревом зв’язного графа G=(V,E)
називається дерево T=(V,ET) таке, що ET ?E.
Кістяковим (каркасним) лісом незв’язного графа G=(V,E)
називається сукупність кістякових (каркасних) дерев зв’язних
компонент графа G.

25

Наслідок 3.11.5. Для зв’язного графа G=(V,E) можна вказати
|E|?|V |+1 ребро, після вилучення яких отримаємо кістякове дерево
графа G.
Очевидно (див. теорему 3.7), що потрібно послідовно вилучати
ребра, які належать циклам [2,7,8]. Порядок вилучення є несуттєвим.
Кількість ребер, що залишаться в кістяковому дереві графа G,
дорівнює |V | ?1, отже, вилученню підлягає
|E| ?(|V | ?1)=|E| ?|V | +1 ребро.
Наслідок 3.11.6. Нехай граф G=(V,E) має k компонент зв’язності.
Для отримання його кістякового лісу з графа G необхідно вилучити
|E| ?|V |+k ребер.
Для доведення цього твердження потрібно застосувати
попередній наслідок до кожної компоненти зв’язності графа G, відтак,
підсумувати результати.
Число |E| ?|V |+k називається цикломатичним числом графа G і
позначається ?(G).
Пропонуємо самостійно довести такі прості властивості
цикломатичного числа ?(G) графа G.
Лема 3.3. 1). Для довільного графа G виконується ?(G) ?0.
2). Граф G є лісом тоді і тільки тоді, коли ?(G)=0.
3). Граф G має рівно один простий цикл тоді і тільки тоді, коли
?(G)=1.
4). Кількість циклів у графі G не менша ніж ?(G).
Алгоритми знаходження кістякових дерев (кістякових лісів) для
заданих графів можна побудувати на основі вищезгаданих
алгоритмів пошуку вшир або вглиб [2,7,8].
Граф G=(V,E) називається двочастковим, якщо існує розбиття
{V1,V2} множини вершин V на дві підмножини (частки) таке, що для
довільного ребра (v,w)?E виконується або v?V1 i w?V2, або v?V2 i
w?V1.
Двочастковий граф G=(V,E) називається повним двочастковим
графом, якщо для будь-якої пари вершин його часток v?V1 i w?V2
маємо (v,w)?E. Якщо |V1|=m i |V2|=n, то повний двочастковий граф G
позначається Km,n.
Теорема 3.12 (теорема Кеніга). Граф є двочастковим тоді і
тільки тоді, коли всі його цикли мають парну довжину.
Доведення. Необхідність. Нехай G ? двочастковий граф, а Z ?
цикл графа G. Будь-який маршрут у графі G, що веде з довільної
вершини v однієї частки V ? у будь-яку вершину тієї ж частки, завжди
має парну довжину, оскільки всі непарні ребра цього маршруту

26

ведуть з частки V ? в іншу частку, а всі парні ребра ? навпаки,
повертають маршрут у V ?. Отже, і довжина циклу Z є парне число.
Достатність. Нехай усі цикли графа G мають парну довжину.
Розглянемо довільну зв’язну компоненту G ?=(V ?,E ?) графа G.
Візьмемо вершину v цієї компоненти і побудуємо розбиття {V1,V2}
множини вершин V ? на дві частки таким чином: віднесемо до V1 всі
вершини w?V ? для яких відстань d(v,w) є число парне, а до
V2 ? всі вершини u?V ?, для яких відстань d(v, u) є число непарне.
Доведемо, що жодні дві вершини з однієї частки не є суміжними в
графі G. Припустімо, що v1 і v2 дві різні вершини з однієї частки й
існує ребро (v1,v2)?E ?. Тоді жодна з вершин v1 і v2 не збігається з v,
оскільки v?V1, а всі вершини, суміжні з v, належать частці V2.
Позначимо через L1 і L2 найкоротші прості ланцюги, що ведуть з v
у v1 і v2 відповідно. Довжини цих ланцюгів мають однакову парність,
бо, за припущенням, v1 і v2 належать одній частці. Нехай u ? остання
спільна вершина L1 і L2 (починаючи від v). Довжини частин обох цих
ланцюгів, що ведуть з u у v1 і з u у v2, також матимуть однакові
парності. Тоді маршрут, що складається з частки L1, що веде з u у v1,
далі містить ребро (v1,v2) і завершується часткою L2, що веде з v2 в u
(тобто проходиться у зворотному порядку) є циклом, довжина якого
непарна. Це суперечить умові. Отже, будь-яка зв’язна компонента
графа G є двочастковим графом, а тому, і сам граф G є
двочастковим.
Наслідок 3.12.1. Граф є двочастковим тоді і тільки тоді, коли він
не має простих циклів непарної довжини.
Наслідок 3.12.2. Будь-яке дерево є двочастковим графом.
Наслідок 3.12.3. Простий цикл парної довжини C2k є двочастковим
графом.
10. Плоскі та планарні графи
У багатьох випадках не має особливого значення, як зобразити
граф у вигляді рисунка на площині (діаграми), оскільки ізоморфні
графи подібні за своєю структурою і містять ту саму інформацію.
Однак існують ситуації, коли необхідно, щоб зображення графа на
площині задовольняло певні умови. Наприклад, якщо граф є
моделлю деякої електронної схеми або транспортної мережі, де
вершинами є окремі елементи схеми або станції, а ребрами,
відповідно, ? електричні провідники і шляхи, то бажано так
розташувати ці ребра на площині, щоб уникнути перетинів.
Таким чином виникає поняття плоского графа.

27

Граф називається плоским, якщо його діаграму можна зобразити
на площині так, що лінії, які відповідають ребрам графа, не
перетинаються (тобто мають спільні точки тільки у вершинах графа).
Таке зображення називається плоскою картою графа.
Граф називають планарним, якщо він ізоморфний деякому
плоскому графу.
Наприклад, граф, зображений на рис.3.7,а, планарний, оскільки
він ізоморфний графу, зображеному поруч. Простий цикл, дерево і
ліс ? це також планарні графи.
Очевидними є такі твердження.
Лема 3.4. 1). Будь-який підграф планарного графа є планарним.
2). Граф є планарним тоді і тільки тоді, коли кожна його зв’язна
компонента ? планарний граф.
Про планарні графи кажуть, що вони укладаються на площині
або мають плоске укладання.

а) б)
Рис.3.7

Жордановою кривою будемо називати неперервну лінію, яка не
перетинає сама себе. Гранню плоского графа назвемо множину
точок площини, кожна пара яких може бути з’єднана жордановою
кривою, що не перетинає ребер графа. Межею грані будемо вважати
замкнений маршрут, що обмежує цю грань.
На рис.3.8 зображено плоский граф із п’ятьма гранями.

Рис.3.8

v13

v14

v3
v2

v1

v4
v5
v6

v10

v8 v9

v11

v12

v7

1
2
3
5

4

28

Отже, плоский граф розбиває всю множину точок площини на
грані так, що кожна точка належить деякій грані. Відзначимо, що
плоский граф має одну, причому єдину, необмежену грань (на рис.3.8
це грань 5). Таку грань будемо називати зовнішньою, а всі інші ?
внутрішніми гранями.
Множину граней плоского графа позначатимемо через P.
Степенем грані r називатимемо довжину циклічного шляху, що
обмежує грань r (тобто довжину межі грані r); позначається ?r
.

Для плоского графа на рис.3.8 {v3,(v3,v2),v2,(v2,v4),v4,(v4,v3),v3} ?
циклічний шлях для грані 1, {v2,(v2,v5),v5,(v5,v7),v7,(v7,v5),v5,(v5,v8),
v8,(v8,v10),v10,(v10,v6),v6,(v6,v2),v2} ? циклічний шлях для грані 3. Отже,
?1=3 i ?3=7.
Лема 3.5. Нехай G=(V,E) плоский граф, тоді
?
r ?P
?r=2 |E|.

Доведення. Справді, кожне ребро плоского графа або розділяє дві
різні грані, або знаходиться всередині однієї грані. Отже, кожне
ребро графа G або входить у межі тільки двох граней, або є
елементом межі лише однієї грані, але при циклічному обході цієї
грані таке ребро проходиться двічі. Тобто кожне ребро плоского
графа вносить у розглядувану суму дві одиниці.
Теорема 3.13. (теорема Ейлера). Для будь-якого зв’язного
плоского графа G=(V,E) виконується рівність

|V |?|E|+|P|=2. (3.3)
Доведення. Нехай G=(V,E) зв’язний плоский граф з n = |V |
вершинами, а T =(V,ET) ? деяке кістякове дерево графа G. Очевидно,
що дерево T має тільки одну грань (зовнішню). Кількість ребер
дерева T дорівнює |ET |=|V |?1. Отже, для кістякового дерева T
формула (3.3) виконується.
Відтак, будемо послідовно проводити в дереві T ребра графа G з
множини E \ET. При цьому на кожному кроці цієї процедури кількість
вершин |V | залишатиметься незмінною, а кількість ребер і кількість
граней (див. теорему 3.11) одночасно збільшуватимуться на
одиницю. Таким чином, формула Ейлера (3.3) виконується після
кожної такої операції, тому вона справедлива і для графа G, який
отримаємо у підсумку всієї процедури.
Наслідок 3.13.1. Кількість граней будь-якого плоского укладання
зв’язного планарного графа з n вершинами і m ребрами є величиною
сталою і дорівнює m ?n +2, тобто |P|=|E| ?|V |+2.
Інакше кажучи, число |P| є інваріантом для заданого планарного
графа G, тобто не залежить від способу укладання його на площині.
Наслідок 3.13.2. Для довільного зв’язного планарного графа
G=(V,E) з не менше ніж трьома вершинами виконується
|E| ? 3 |V | ? 6.

29

Оскільки в графі G відсутні петлі та кратні ребра, то степінь ?r
будь-якої грані не менше 3, тобто
?
r ?P
?r ? 3 |P|.

Звідси, враховуючи співвідношення з леми 3.5 і попереднього
наслідку, маємо
?
r ?P
?r=2 |E| ? 3(|E| ? |V |+2) і, нарешті, |E| ? 3 |V | ? 6.
Наслідок 3.13.3. У будь-якому планарному графі є принаймні одна
вершина, степінь якої не перевищує 5.
Справді, якщо припустити, що степені всіх вершин планарного
графа G=(V,E) більші, ніж 5, то дістанемо нерівність
2 |E|=
?
v ?V
?(v) ? 6 |V |, яка суперечить попередньому наслідку.
Формулу Ейлера можна узагальнити.
Наслідок 3.13.4. Для довільного планарного графа G=(V,E) з k
компонентами зв’язності виконується

|V |?|E|+|P|= k +1. (3.4)
Для доведення узагальненої формули Ейлера можна побудувати
кістяковий ліс F графа G, переконатись у тому, що для F наведена
рівність виконується (див. наслідок 3.11.3), відтак, повторити
міркування теореми 3.13.
Цей наслідок можна довести й іншим методом.
Якщо Vi
, Ei
та Pi - відповідні множини вершин, ребер і граней i-ї

зв’язної компоненти графа G, то |Pi
|=|Ei
|?|Vi
| +2. Спільних
внутрішніх граней різні компоненти не мають, а зовнішня грань для
всіх компонент єдина і рахується по одному разу для кожної з них.
Тому загальна кількість граней графа G дорівнюватиме
|P|=
i
n
?
?
1
|Pi
|?(k?1)=
i
n
?
?
1
(|Ei
|?|Vi
| +2)?(k?1) =
i
n
?
?
1
|Ei
| ?
i
n
?
?
1
|Vi
| +2k ?

?(k?1)=|E|?|V | +k+1.
Звідси дістанемо формулу (3.4).
Наслідок 3.13.5. Кількість внутрішніх граней довільного плоского
графа G дорівнює цикломатичному числу ?(G) графа G.
Щоб переконатись у справедливості цього твердження потрібно
порівняти означення цикломатичного числа ?(G) (див. розділ 9) та
узагальнену формулу Ейлера (3.4), взявши до уваги, що кількість
внутрішних граней дорівнює |P|?1.
Наслідок 3.13.6. Графи G і
G
не можуть бути одночасно

планарними, якщо кількість вершин у них не менше 11.
Справедливість твердження випливає з того, що нерівність з
наслідку 3.13.2 не може одночасно виконуватися для графів G і
G
з

кількістю вершин |V | ? 11.

30

При дослідженні плоских графів особливе місце займають графи
K5 i K3,3, зображені на рис.3.9.

K5 K3,3
Рис.3.9

Теорема 3.14. Графи K5 i K3,3 не є планарними.
Доведення. Доведемо, що граф K5 не є планарним. Припустімо
супротивне, тобто, що K5=(V,E) ? планарний граф. Тоді з наслідку
3.13.2 випливає, що |E| ? 3 |V | ? 6. Однак, для графа K5 |E|=10 i |V |=5,
тобто повинно виконуватись 10 ? 3?5 ? 6 = 9, що неможливо. Отже,
припущення про те, що K5 планарний граф ? неправильне.
Аналогічно, методом від супротивного доведемо, що K3,3 не є
планарним. В графі K3,3 жодні три вершини не є вершинами
трикутника. Отже, ?r ? 4 для всіх граней r ?P. Припускаючи, що граф
K3,3 планарний, з наслідку 3.13.1 отримаємо
|P|=|E|?|V |+2 = 9?6+2 =5. Тоді 2 |E|=
?
r ?P
?r ? 4 |P| = 4?5 = 20, тобто

|E| ? 10, що невірно для графа K3,3. Теорему доведено.
Значення графів K5 i K3,3 полягає в тому, що вони є "єдиними"
суттєво непланарними графами. Всі інші непланарні графи містять у
собі підграфи "подібні" до K5 або K3,3. Характер цієї подібності
розкривається за допомогою таких понять.
Елементарним стягуванням графа G=(V,E) називається
вилучення в графі G деякого ребра (vi

,vj)?E і злиття вершин vi
i vj в
одну вершину v, причому v інцидентна всім тим відмінним від (vi
,vj)

ребрам графа G, які були інцидентні або vi
, або vj
.

Кажуть, що граф G стягується до графа G?, якщо G? можна
отримати з G за допомогою послідовності елементарних стягувань.
Приклад 3.9. На рис.3.10 зображено графи G i G?, при цьому G
стягується до G?.

G G ?
Рис.3.10

31

Наведемо без доведення важливу теорему теорії графів.
Теорема 3.15 (теорема Куратовського). Граф G є планарним
тоді і тільки тоді, коли він не містить підграфів, що стягуються до K5
або K3,3.
Ця теорема лежала в основі перших алгоритмів перевірки
планарності графів. Однак час роботи таких алгоритмів був
пропорційний |V |
6
. Згодом були створені значно швидші алгоритми,
що здійснювали перевірку планарності графа G=(V,E) за час O(|V |)
[8]. У монографіях [2,8] описані також процедури, які для планарних
графів знаходять плоскі укладання.
11. Розфарбування графів
Нехай G=(V,E) довільний граф, а Nk={1,2,...,k }.
Будь-яке відображення f :V?Nk, яке ставить у відповідність кожній
вершині v?V деяке натуральне число f(v) ?Nk, називається
розфарбуванням графа G. Число f (v) називається кольором або
номером фарби вершини v.
Розфарбування f графа G називається правильним, якщо для
будь-яких його суміжних вершин v і w виконується f (v)? f(w).
Мінімальне число k, для якого існує правильне розфарбування
графа G, називається хроматичним числом графа G і
позначається ?(G).
Мінімальним правильним розфарбуванням графа G
називається правильне розфарбування для k=?(G).
Для певних типів графів визначити хроматичні числа нескладно.
Наприклад, 1-хроматичними є порожні графи G=(V,?) і тільки вони.
Хроматичне число повного графа Kn дорівнює n, а хроматичне число
довільного двочасткового графа ? 2. 2-хроматичні графи часто
називають біхроматичними.
Очевидними є такі твердження.
Лема 3.6. Якщо кожна зв’язна компонента графа G потребує для
свого правильного розфарбування не більше k фарб, то ?(G)?k.
Лема 3.7. Граф є біхроматичний тоді і тільки тоді, коли він
двочастковий.
Зокрема, всі дерева і прості цикли парної довжини C2k є
біхроматичні. У той же час, ?(C2k+1)=3.
Використовуючи теорему 3.12, останню лему можна
переформулювати у такому вигляді.
Лема 3.8. Граф є біхроматичний тоді і тільки тоді, коли він не має
циклів непарної довжини.
Проблема визначення, чи є заданий граф k-хроматичним для
певного k, та проблема знаходження мінімального правильного

32

розфарбування для заданого графа належать до класу задач, для
яких на сьогодні не існують (і є всі підстави вважати, що не існують
взагалі) ефективні точні алгоритми їх розв’язку [2,7,8]. Тому
важливими є результати, які дозволяють оцінити значення
хроматичного числа ?(G), виходячи з певних характеристик та
властивостей графа G.
Теорема 3.16. Позначимо через ?(G) найбільший зі степенів
вершин графа G, тоді ?(G)??(G)+1.
Доведення проведемо індукцією за кількістю n вершин графа G.
Для тривіального графа (n=1) і графів з двома вершинами нерівність
виконується.
Нехай твердження теореми виконується для всіх графів з
кількістю вершин t (t ? 2). Розглянемо довільний граф G з t +1
вершиною. Вилучимо з G деяку вершину v, дістанемо граф G ?, всі
степені вершин якого не перевищують ?(G). Отже, за припущенням
індукції, для правильного розфарбування G ? потрібно не більше ніж
?(G)+1 фарба. Правильне розфарбування для G дістанемо з
правильного розфарбування графа G?, якщо пофарбуємо вершину v
у колір, відмінний від кольорів усіх суміжних із v вершин. Оскільки
таких вершин не більше, ніж ?(G), то для правильного
розфарбування графа G достатньо ?(G)+1 фарба.
Наслідок 3.16.1. Для правильного розфарбування довільного
кубічного графа достатньо чотири фарби.
Так склалося історично, що окреме місце в теорії графів займають
дослідження з розфарбування планарних графів. Пов’язано це зі
славетною проблемою або гіпотезою чотирьох фарб.
Грані плоскої карти назвемо суміжними, якщо їхні межі мають
принаймні одне спільне ребро.
Гіпотеза чотирьох фарб виникла у зв’язку з розфарбуванням
друкованих географічних карт (звідси й термін "плоска карта") і
формулювалась так:
“Грані довільної плоскої карти можна розфарбувати не більше
ніж чотирма фарбами так, що будь-які суміжні грані матимуть
різні кольори”.
Згодом з’явилось інше, рівносильне, формулювання гіпотези
чотирьох фарб.
Для правильного розфарбування вершин довільного планарного
графа потрібно не більше чотирьох фарб.
Ця гіпотеза виникла в середині ХIХ століття. Більше ста років
професійні та непрофесійні дослідники намагалися довести або
спростувати цю гіпотезу. В результаті багаторічних досліджень
виявилось, що для вирішення проблеми чотирьох фарб необхідно

33

перевірити її справедливість для скінченного числа графів певного
виду. Кількість варіантів, які потрібно було перебрати, була настільки
великою, що тільки за допомогою потужної ЕОМ, яка неперервно
працювала протягом більше двох місяців, у 1976 році справедливість
гіпотези чотирьох фарб була підтверджена. Однак такий "фізичний"
експериментальний спосіб доведення не зовсім влаштовує багатьох
професійних математиків, і вони продовжують пошуки аналітичного
доведення гіпотези.
Набагато простіше можна отримати такі результати.
Теорема 3.17. Планарний граф є біхроматичний тоді і тільки тоді,
коли степені всіх його граней парні.
Справедливість твердження теореми випливає з того, що в
планарному графі, степені всіх граней якого парні, відсутні цикли
непарної довжини (доведіть це самостійно). Отже, для нього
виконується критерій леми 3.8.
Теорема 3.18. Для правильного розфарбування довільного
планарного графа потрібно не більше шести фарб.
Доведення проведемо індукцією за кількістю n вершин планарного
графа. Для n?6 твердження очевидне. Припустимо, що хроматичне
число всіх планарних графів з t вершинами не перевищує 6 (t ?6).
Розглянемо довільний планарний граф G з t+1 вершиною. Згідно з
наслідком 3.13.3 у графі G існує вершина v, степінь якої не більше 5.
Вилучимо вершину v з графа G. Отримаємо граф G?, вершини якого
за припущенням індукції можна правильно розфарбувати не більше
ніж у шість кольорів. Тоді правильне розфарбування для G
отримаємо з одержаного правильного розфарбування графа G?,
надаючи вершині v колір, відмінний від кольорів усіх суміжних з нею
вершин. Оскільки таких вершин не більше п’яти, то для виконання
цієї процедури шести фарб буде достатньо. Отже, ?(G) ? 6.
Пропонуємо самостійно переконатись у справедливості такого
твердження.
Теорема 3.19. Для довільного планарного графа G виконується
?(G) ? 5.
Нарешті, завершимо цю тему зауваженням, що існують планарні
графи, хроматичне число яких дорівнює 4. Найпростішим таким
графом є K4. Отже, гіпотезу чотирьох фарб не можна "вдосконалити",
перетворивши у "гіпотезу трьох фарб".
Різноманітні точні та наближені алгоритми знаходження
правильних розфарбувань графів можна знайти в монографії [8].
12. Обходи графів

34

Початок теорії графів як розділу математики пов’язують із так
званою задачею про кенігсберзькі мости. Сім мостів міста Кенігсберга
були розташовані на річці Прегель так, як зображено на рис.3.11,а.

а) б)

Рис.3.11

Задача полягає в тому, чи можна, починаючи з будь-якої точки
(А,B,C або D), здійснити прогулянку (обхід) через усі мости так, щоб
пройти кожен міст тільки один раз і повернутися у вихідну точку.
Оскільки суттєвими є тільки переходи через мости, то план міста
можна зобразити у вигляді графа G (з так званими кратними
ребрами), вершинами якого є береги і острови (точки А,В,С і D), а
ребрами ? мости (див. рис.3.11,б). Тоді задачу про кенігсберзькі
мости можна мовою теорії графів сформулювати таким чином: чи
існує в графі G цикл, який містить усі ребра цього графа? Інше
відоме формулювання цієї проблеми виглядає так: чи можна
намалювати фігуру, що зображає граф G, не відриваючи олівця від
паперу і не повторюючи ліній двічі, почавши і закінчивши цю
процедуру в одній з вершин фігури? Вперше відповідь на це питання
дав Л.Ейлер у 1736 році. Робота Ейлера, яка містить цей розв’язок,
вважається початком теорії графів.
Цикл, який містить усі ребра графа, називається ейлеровим
циклом. Зв’язний граф, який має ейлерів цикл, називається
ейлеровим графом.
Теорема 3.20 (теорема Ейлера). Зв’язний граф G є ейлеровим
тоді і тільки тоді, коли степені всіх його вершин парні.
Доведення. Необхідність. Нехай G ? ейлерів граф. Ейлерів цикл
цього графа, проходячи через кожну вершину, заходить у неї по
одному ребру, а виходить ? по іншому. Це означає, що кожна
вершина інцидентна парній кількості ребер ейлерового циклу, а
оскільки цей цикл містить усі ребра графа, то звідси випливає
парність степенів усіх вершин графа.

C

A D

B

35

Достатність. Припустимо, що степені всіх вершин графа
G=(V,E) парні. Візьмемо деяку вершину v1?V і розпочнемо з неї обхід
графа, кожен раз обираючи ребро, яке раніше не використовувалось.
Оскільки степінь кожної вершини парний і ненульовий, то цей шлях
може закінчитися тільки у вершині v1, утворивши таким чином цикл
Z1. Якщо в результаті описаного процесу використано всі ребра
графа G, то шуканий ейлерів цикл побудовано. Якщо ж Z1 містить не
всі ребра графа G, то вилучимо з G всі ребра, які входять у Z1.
Одержимо граф G1 ? підграф графа G, всі вершини якого також
матимуть парні степені (це випливає з того, що і G, i Z1 мають
вершини тільки парних степенів). Крім того, внаслідок зв’язності
графа G Z1 i G1 мають принаймні одну спільну вершину v2. Відтак,
починаючи з вершини v2, побудуємо цикл Z2 у графі G1. Позначимо
через Z1

? частину циклу Z1 від v1 до v2, а через Z1

?? ? частину циклу Z1

від v2 до v1. Отримаємо новий цикл Z1

?, Z2, Z1

??, що веде з v1 у v1.
Якщо цей цикл ейлерів ? процес завершився. У противному разі
продовжуємо аналогічні побудови ще раз і т.д. Цей процес
завершиться побудовою шуканого ейлерового циклу.
Оскільки для графа G з рис.3.11,б умови теореми Ейлера не
виконуються, то в задачі про кенігсберзькі мости відповідь негативна.
Якщо G ? ейлерів граф, то будь-який його ейлерів цикл неєдиний і
відрізняється від інших ейлерових циклів графа G принаймні або
зміною початкової вершини і/або зміною порядку проходження.
Для знаходження деякого ейлерового циклу в ейлеровому графі G
можна застосувати так званий алгоритм Фльорі. Фіксуємо довільну
початкову вершину циклу. На кожному кроці процедури до шуканого
циклу обираємо (доки це можливо) те ребро, після вилучення якого
граф не розіб’ється на дві нетривіальні зв’язні компоненти. Кожне
обране ребро вилучаємо з G. Процедура завершується, коли всі
ребра буде вичерпано. Неважко обгрунтувати, що сформульований
алгоритм будує ейлерів цикл графа G [2].
Існує ще один різновид обходу графа, який має різноманітні
практичні застосування і називається гамільтоновим циклом.
Простий цикл, який проходить через усі вершини графа, називається
гамільтоновим циклом. Граф називається гамільтоновим, якщо
він має гамільтонів цикл.
Не зважаючи на певну подібність означень ейлерових і
гамільтонових графів, на жаль, для розпізнавання гамільтоновості
графів на сьогодні не існує таких простих і вичерпних критеріїв та
алгоритмів, як для ейлерових графів. Iснує декілька теорем, що
формулюють достатні умови існування гамільтонового циклу в

36

заданому графі. Доведення таких теорем, як правило, містить у собі
й алгоритми побудови відповідних гамільтонових циклів.
Зв’язок між ейлеровими і гамільтоновими циклами заданого графа
G і відповідними циклами так званого реберного графа L(G)
встановлюється за допомогою нижченаведених тверджень.
Множина V? вершин графа L(G) рівнопотужна множині ребер E
графа G, тобто існує бієкция ? :V??E. Вершини v,w ?V? з’єднуються
ребром у графі L(G), тоді й лише тоді, коли відповідні їм ребра ? (v) і
? (w) інцидентні одній і тій же вершині в графі G.
Теорема 3.21. Якщо граф G має ейлерів цикл, то граф L(G) має
як ейлерів, так і гамільтонів цикли.
Теорема 3.22. Якщо граф G має гамільтонів цикл, то граф L(G)
також має гамільтонів цикл.
13. Орієнтовані графи
Крім моделі, яка була розглянута у попередніх розділах, у теорії
досліджуються й інші типи графів. Наприклад,
мультиграф ? граф, в якому припускаються кратні ребра, тобто
будь-які дві вершини можна з’єднати декількома ребрами.
Псевдограф ? мультиграф, який може мати петлі, тобто ребра, що
з’єднують вершину саму з собою. Гіперграф ? граф, в якому ребрами
можуть бути не лише двоелементні, але довільні підмножини
множини вершин. Нарешті, важливою для різноманітних практичних
застосувань є модель, яка називається орієнтованим графом або
орграфом. У цьому розділі дамо короткий огляд основних понять і
результатів для орграфів.
Орієнтованим графом, або орграфом, G називається пара
множин (V,E), де Е ?V?V. Елементи множини V називаються
вершинами орграфа G, а елементи множини Е ? дугами орграфа
G =(V,E). Отже, дуга ? це впорядкована пара вершин. Відповідно, V
називається множиною вершин і Е ? множиною дуг орграфа G.
Якщо е= (v,w) ? дуга, то вершина v називається початком, а
вершина w ? кінцем дуги е. Кажуть, що дуга е веде з вершини v у
вершину w або виходить з v і заходить у w. Дугу е і вершини v та w
називають інцидентними між собою, а вершини v i w суміжними.
Дуга (v,v), в якій початок і кінець збігаються називається петлею.
Надалі розглядатимемо тільки орграфи без петель.
Як і звичайний граф, орграф G=(V,E) може бути заданий шляхом
переліку елементів скінченних множин V i E, діаграмою або за
допомогою матриць.

37

Діаграма орграфа відрізняється від діаграми звичайного графа
тим, що дуги орграфа зображаються напрямленими лініями
(відрізками або кривими), що йдуть від початку до кінця дуги.
Напрямок лінії позначається стрілкою.
Занумеруємо всі вершини орграфа G=(V,E) натуральними
числами від 1 до n; дістанемо множину вершин V у вигляді
{v1,v2,...,vn}. Матрицею суміжності А орграфа G називається
квадратна матриця порядку n, в якій елемент і-го рядка і j-го
стовпчика

1, якщо (vi
,vj)?E;

aij =
0, у противному разі.

Занумеруємо всі вершини орграфа G=(V,E) числами від 1 до n, а
дуги ? числами від 1 до m. Матрицею інцидентності В орграфа G
називається n?m-матриця, в якій елемент і-го рядка і j-го стовпчика

1, якщо вершина vi є початком дуги ej
;
bij = ?1, якщо вершина vi є кінцем дуги ej
;

1, якщо вершина vi

і дуга ej неінцидентні.

Орграфи G1=(V1,E1) i G2=(V2,E2) називаються ізоморфними, якщо
існує таке взаємно однозначне відображеня ? множини V1 на
множину V2, що дуга (v,w)?Е1 тоді і тільки тоді, коли дуга
(? (v),? (w))?Е2.
Очевидно, що теорема 3.1 справедлива і для орграфів.
Півстепенем виходу вершини v (позначається ?
+
(v)) орграфа G
називається кількість дуг орграфа G, початком яких є вершина v.
Півстепенем заходу вершини v (позначається ?

—(v)) орграфа G

називається кількість дуг орграфа G, кінцем яких є вершина v.
Аналогічно теоремі 3.3 може бути доведено таку теорему.
Теорема 3.23. Для будь-якого орграфа G=(V,E) виконуються
рівності
?
v ?V
?
+
(v) =
?
v ?V
?
—(v)= |E|.

Значна частина властивостей та тверджень стосовно звичайних
графів може бути без змін сформульована і для орграфів. Зокрема,
це стосується цілих розділів, таких, наприклад, як планарність або
розфарбування графів, в яких наявність орієнтації ребер не є
суттєвою. Певні особливості в означеннях, постановках задач та
методах їх розв’язування виникають при дослідженні проблем,
пов’язаних з маршрутами, зв’язністю, обходами графів тощо.
Маршрутом або шляхом в орграфі G=(V,E) називається
послідовність його вершин і дуг

38

v1, e1, v2, e2, ... , ek, vk +1 (3.5)
така, що ei=(vi

,vi +1), i=1,2,...,k. Кажуть, що цей маршрут веде з
вершини v1 у вершину vk +1. Число k дуг у маршруті (3.5) називається
його довжиною.
Маршрут, в якому всі дуги попарно різні, називається ланцюгом.
Маршрут, в якому всі вершини попарно різні, називається простим
ланцюгом. Маршрут (3.5) називається замкненим (або циклічним),
якщо v1=vk +1. Замкнений ланцюг називається циклом, а замкнений
простий ланцюг ? простим циклом, або контуром.
Лема 3.2 виконується і для орграфів.
Орграф називається ациклічним (або безконтурним), якщо він
не має жодного циклу.
Якщо існує маршрут, який веде з вершини v у вершину w, то
кажуть, що вершина w є досяжною з вершини v. У цьому випадку
відстанню d(v,w) від вершини v до вершини w називається довжина
найкоротшого маршруту, що веде з v y w. Відстань між вершиною v i
вершиною w, яка є недосяжною з v, позначається символом ?.
Лема 3.9. 1). Відношення досяжності на множині вершин орграфа
є транзитивним.
2). Якщо в орграфі G вершина w є досяжною з вершини v, а
вершина u є досяжною з вершини w, то d(v,w)+d(w, u) ? d(v, u).
Вершина v орграфа G називається джерелом, якщо з v є
досяжною будь-яка інша вершина орграфа G. Вершина w
називається стоком, якщо вона є досяжною з будь-якої іншої
вершини орграфа G.
Повним орграфом (або турніром) називається орграф G, в
якому будь-які дві вершини є інцидентними одній і тільки одній дузі
орграфа G.
Для повних орграфів справедливі такі твердження.
Теорема 3.24. Для довільного повного орграфа G=(V,E) з n
вершинами виконуються такі рівності
(а)
?
i ?
n
1
?
+
(vi) =
?
i ?
n
1
(n?1??
+
(vi)) =|E|=n(n-1)/2;

(б)
?
i ?
n
1
(?
+
(vi))2
= ?
i ?
n
1
(n?1??
+
(vi))2
= ?
i ?
n
1
(?
?
(vi))2
.

Теорема 3.25. У будь-якому повному орграфі завжди є принаймні
одне джерело і принаймні один стік.
Теорема 3.26. У будь-якому повному орграфі існує простий
ланцюг, який приходить через усі вершини орграфа.
Послідовність (3.4) називається напівмаршрутом, якщо кожна
дуга еі цієї послідовності є такою, що або еi = (vi

,vi +1), або ei = (vi +1,vi).

39

(Можна вважати, що при побудові напівмаршруту ми ігноруємо
орієнтацію дуг орграфа). Аналогічно означаються напівланцюг,
напівцикл і напівконтур.
Орграф називається сильно зв’язним, якщо будь-які дві його
вершини є досяжними одна з одної. Орграф називається однобічно
зв’язним, якщо для будь-яких двох його вершин принаймні одна з
них є досяжною з іншої. Орграф називається слабо зв’язним, якщо
для будь-яких двох його вершин існує напівмаршрут, що веде з однієї
вершини в іншу.
Маршрут в орграфі G назвемо кістяковим, якщо він містить всі
вершини орграфа G. Сформулюємо необхідні та достатні умови для
кожного з типів зв’язності.
Теорема 3.27. Орграф є сильно зв’язним тоді і тільки тоді, коли
він має замкнений кістяковий маршрут.
Теорема 3.28. Орграф є однобічно зв’язним тоді і тільки тоді, коли
він має кістяковий маршрут.
Теорема 3.29. Орграф є слабо зв’язним тоді і тільки тоді, коли він
має кістяковий напівмаршрут.
Неважко переформулювати теореми 3.9 і 3.10, їхні наслідки та
алгоритми пошуку вшир і вглиб на випадок різних типів зв’язності
орграфів. Ці ж теореми й алгоритми можна пристосувати для
обчислення відстаней між вершинами заданого орграфа.
Орграф, у якому є джерело і немає жодного напівконтура,
називається кореневим деревом. Вхідне дерево ? це орграф, який
має стік і не має жодного напівконтура.
Орграф називається функціональним, якщо кожна його вершина
має півстепінь виходу, рівний 1. Орграф називається ін’єктивним,
якщо півстепінь заходу кожної його вершини дорівнює 1.
Ейлеровим контуром в орграфі G називається контур, що
містить всі дуги орграфа G. Ейлеровим орграфом називається
орграф, у якому є ейлерів контур. Ейлеровим ланцюгом
називається ланцюг, що містить усі дуги орграфа.
Нижченаведена теорема доводиться так само, як у випадку
звичайних графів.
Теорема 3.30. Слабо зв’язний орграф G=(V,E) є ейлеровим тоді і
тільки тоді, коли у будь-якої його вершини півстепінь виходу дорівнює
півстепеневі заходу.
Гамільтоновим контуром називається контур, що містить усі
вершини орграфа. Орграф, який має гамільтонів контур, називається
гамільтоновим орграфом. Простий ланцюг, що містить всі
вершини орграфа, називається гамільтоновим.
Із теореми 3.26, зокрема, випливає, що повний орграф є
гамільтоновим.

40

Орграф G=(V,E) називається транзитивним, якщо з того, що
(v,w)?Е і (w, u)?Е випливає (v, u)?Е.
Існує взаємно однозначна відповідність між множиною всіх
безконтурних транзитивних орграфів G=(V,E) з множиною вершин
V= {v1,v2,...,vn} і петлями в кожній вершині та множиною всіх
відношень часткового порядку на V. Ця бієкція встановлюється так:
орграфу G=(V,E) відповідає відношення R на V таке, що (vi
,vj)?R

тоді і тільки тоді, коли (vi

,vj)?E, vi
, vj ?V.

14. Граф як модель. Застосування теорії графів
Останнім часом графи і пов’язані з ними методи досліджень
використовуються практично в усіх розділах сучасної математики і,
зокрема, дискретної математики.
Граф є математичною моделлю найрізноманітніших об’єктів,
явищ і процесів, що досліджуються і використовуються в науці,
техніці та на практиці. Коротко опишемо найвідоміші застосування
теорії графів.
Наприклад, у вигляді графа можуть бути зображені:
? електричні і транспортні мережі;
? інформаційні і комп’ютерні мережі;
? карти автомобільних, залізничних і повітряних шляхів, газо- і
нафтопроводів;
? моделі кристалів;
? структури молекул хімічних речовин;
? моделі ігор;
? різні математичні об’єкти (відношення, частково впорядковані
множини, решітки, автомати, ланцюги Маркова, алгоритми і програми
тощо);
? лабіринти;
? плани діяльності або плани виконання певних робіт (розклади);
? генеалогічні дерева тощо.
Приклади застосування теорії графів:
? пошук зв’язних компонентів у комунікаційних мережах;
? пошук найкоротших, “найдешевших” та “найдорожчих” шляхів у
комунікаційних мережах;
? побудова кістякового дерева: зв’язність з найменшою
можливою кількістю ребер;
? пошук максимальної течії для транспортної мережі, в якій
визначено вхідні та вихідні вершини та пропускні спроможності
ребер;
? ізоморфізм графів: ідентичність структур молекул (ізометрія);
? знаходження циклів графів:

41

? гамільтонів цикл: обійти всі вершини графа, побувавши в
кожній з них лише один раз (задача комівояжера);
? ейлерів цикл: обійти всі ребра (контроль дієздатності
мережі);
? розфарбування графів: розфарбування географічних карт,
укладання розкладів, розміщення ресурсів тощо;
? планарність графів: проектування друкованих електронних та
електричних схем, транспортних розв’язок тощо;
? знаходження центрів графа: вершин, максимальна відстань від
яких до всіх інших вершин графа є мінімальною (“столиць”)
тощо.

42

Список літератури

1. Харари Т. Теория графов.- М.,1973.
2. Лекции по теории графов / Емеличев В.А., Мельников О.И.,
Сарванов В.И., Тышкевич Р.И.- М., 1990.
3. Зыков А.А. Основы теории графов.- М., 1987.
4. Оре О. Теория графов.- М., 1980.
5. Свами М., Тхуласираман К. Графы, сети, алгоритмы.- М.,
1984.
6. Уилсон Р. Введение в теорию графов.- М., 1977
7. Кристофидес Н. Теория графов. Алгоритмический подход.-
М.,1978
8. Рейнгольд Э., Нивергельт Ю., Део Н. Комбинаторные
алгоритмы.-М.,1980

43

Навчальне видання

ТРОХИМЧУК Ростислав Миколайович

ТЕОРІЯ ГРАФІВ

Навчальний посібник

для студентів факультету кібернетики

Редактор В.Р.Філь
Молодший редактор